# Generator

## 基本概念

1. Generator 函数是一个状态机，封装了多个内部状态，每次调用 Generator 函数，都返回一个遍历器对象，可以依次遍历函数内部的每一个状态

2. Generator 函数的定义采用`function*`关键字，函数体内部使用`yield`表达式来定义不同的内部状态

3. 调用 Generator 函数会返回一个遍历器对象，用于遍历函数内部的状态。每次调用遍历器对象的`next`方法，内部指针就会从上次停下的地方或函数开头开始执行，直到遇到下一个`yield`表达式或`return`语句

4. 执行过程： 调用`next`方法使得内部指针移动，从一个状态到下一个状态。`next`方法返回一个对象，其中`value`属性表示当前状态的值，而`done`属性表示遍历是否结束

5. 星号位置： 在 Generator 函数的定义中，`function*`星号可以紧跟在`function`关键字后面，或者与函数名之间。在不同位置的星号都是有效的

## yield 表达式

### Generator 函数的运行逻辑

1. 当遇到`yield`表达式时，函数会暂停执行，将紧跟在`yield`后面的表达式的值作为返回的对象的`value`属性值

2. 下一次调用`next`方法时，函数会继续执行，直到遇到下一个`yield`表达式

3. 如果没有再遇到新的`yield`表达式，函数会一直运行到函数结束，直到`return`语句为止，并将`return`语句后面的表达式的值作为返回的对象的`value`属性值

4. 如果函数内部没有`return`语句，则返回的对象的`value`属性值为`undefined`

### `yield`表达式的特点和使用

1. `yield`表达式后面的表达式只有在调用`next`方法并且内部指针指向该语句时才会执行。这为 JavaScript 提供了手动的"惰性求值"的语法功能

2. `yield`表达式和`return`语句都能返回紧跟在语句后面的表达式的值，但是`yield`表达式具有位置记忆的功能。函数内部可以执行多次`yield`表达式，但只能执行一次`return`语句

3. Generator 函数可以不使用`yield`表达式，这时就变成了一个单纯的暂缓执行函数，只有在调用`next`方法时函数才会执行

### 在普通函数中使用`yield`表达式的错误

1. `yield`表达式只能用在 Generator 函数内部，如果在普通函数中使用会导致语法错误

2. 在普通函数中，可以改用`for`循环来模拟遍历 Generator 函数中的`yield`表达式，从而避免语法错误
